<% layout('layouts/boilerplate') -%>

<section class="luxury-form-section">
    <div class="container py-5">
        <div class="form-header-minimal mb-5">
            <a href="/listings/<%= list._id %>" class="back-text-link mb-3 d-inline-block">
                <i class="fa-solid fa-arrow-left-long me-2"></i> BACK TO PROPERTY
            </a>
            <h1 class="serif-title">EDIT RESIDENCE</h1>
            <p class="text-muted italic">Refine the details of your luxury listing</p>
        </div>

        <div class="row justify-content-center">
            <div class="col-lg-10">
                <form action="/listings/<%= list._id %>?_method=PUT" method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
                    
                    <div class="row">
                        <div class="col-md-7 pe-md-5">
                            <div class="mb-4">
                                <label class="luxury-label">PROPERTY TITLE</label>
                                <input type="text" name="listing[title]" class="luxury-input" value="<%= list.title %>" required />
                                <div class="invalid-feedback">A title is required for the residence.</div>
                            </div>

                            <div class="mb-4">
                                <label class="luxury-label">DESCRIPTION</label>
                                <textarea name="listing[description]" class="luxury-input" rows="8" required><%= list.description %></textarea>
                                <div class="invalid-feedback">Please provide a sophisticated description.</div>
                            </div>

                            <div class="row">
                                <div class="col-md-6 mb-4">
                                    <label class="luxury-label">LOCATION</label>
                                    <input type="text" name="listing[location]" class="luxury-input" value="<%= list.location %>" required />
                                </div>
                                <div class="col-md-6 mb-4">
                                    <label class="luxury-label">COUNTRY</label>
                                    <input type="text" name="listing[country]" class="luxury-input" value="<%= list.country %>" required />
                                </div>
                            </div>
                        </div>

                        <div class="col-md-5">
                            <div class="mb-4">
                                <label class="luxury-label">CURRENT VISUAL</label>
                                <div class="edit-preview-box shadow-sm">
                                    <img src="<%= list.image.url %>" alt="Preview" class="img-fluid" />
                                </div>
                            </div>

                            <div class="mb-4">
                                <label class="luxury-label">UPLOAD NEW IMAGE</label>
                                <input type="file" name="listing[image]" class="luxury-input file-input-style" accept="image/*" />
                                <small class="text-muted d-block mt-2">Optional: high-resolution images only</small>
                            </div>

                            <div class="mb-4">
                                <label class="luxury-label">PRICE PER NIGHT (â‚¹)</label>
                                <input type="number" name="listing[price]" class="luxury-input" value="<%= list.price %>" min="1" required />
                            </div>

                            <div class="mb-5">
                                <label class="luxury-label">COLLECTION / CATEGORY</label>
                                <select name="listing[category]" class="luxury-input" required>
                                    <option value="Mountain" <%= list.category === 'Mountain' ? 'selected' : '' %>>Mountain</option>
                                    <option value="Beach" <%= list.category === 'Beach' ? 'selected' : '' %>>Beach</option>
                                    <option value="Forest" <%= list.category === 'Forest' ? 'selected' : '' %>>Forest</option>
                                    <option value="Desert" <%= list.category === 'Desert' ? 'selected' : '' %>>Desert</option>
                                    <option value="Farm" <%= list.category === 'Farm' ? 'selected' : '' %>>Farm</option>
                                    <option value="Luxury" <%= list.category === 'Luxury' ? 'selected' : '' %>>Luxury</option>
                                    <option value="Camping" <%= list.category === 'Camping' ? 'selected' : '' %>>Camping</option>
                                </select>
                            </div>

                            <button type="submit" class="gold-button w-100 py-3">SAVE CHANGES</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>